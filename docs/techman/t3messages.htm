<html>
<!-- DERIVED FILE - DO NOT EDIT -->

<head>
<title>Where Messages Come From</title>
<link rel="stylesheet" href="techman.css" type="text/css">
</head>
<body>
<div class="topbar"><img src="topbar.jpg" border=0></div>
<div class="nav">
<a class="nav" href="toc.htm">Table of Contents</a> | 
<a class="nav" href="depth.htm">TADS 3 In Depth</a> &gt; 
Where Messages Come From
<br><span class="navnp"><a class="nav" href="depth.htm"><i>Prev:</i> TADS 3 In Depth</a> &nbsp;&nbsp;&nbsp; <a class="nav" href="t3res.htm"><i>Next:</i> Action Results</a> &nbsp;&nbsp;&nbsp; </span>

</div>
<div class="main">
<h1>Where Messages Come From</h1>
<h2>(Being adapted for adv3Lite)</h2>

<h2>Anatomy of a Transcript</h2>
<p>When you start writing your own game and testing it, you'll find that the library takes care of a good deal of the work for you. Mainly, that's a benefit, but sometimes it can become a problem, particularly when the library doesn't quite do what you want but you can't see how to change it. That's where this article may be able to help. Immediately below we give <a href='#sampleTrans'>a sample transcript</a> from a simple TADS 3 game. Next to the various parts of the transript you'll find numbered links, like this <a href='#showintro'>[1]</a>. Clicking on the link will take you to an explanation of where the message is coming from, often with some hints on how to change it, or a reference to some other documentation that explores the relevant library feature in more detail.</p>

<p>This article also contains the full <a href='#sourcecode'>source code</a> for the game from which the sample transcript was taken. Where appropriate the explanations for a given feature are linked to the appropriate object in the source code. This lets you click on a numbered link in the transcript to read an explanation, and then click on a link in the explanation to see the relevant part of the TADS 3 source.</p>

<p>Parts of this sample game are deliberately unpolished; showing examples of things <i>not</i> working properly can sometimes be more instructive than showing everything working properly, and if you're using this sample transcript to locate things that aren't quite right in your own game, it may help if they match things that aren't quite right in this sample game.</p>

<p>Reading this article through sequentially from beginning to end may not be the best way to use it. You may find it more helpful to read through the sample transcript below, and then click on the numbered link when you see something that interests you.</p>
<br>
<hr>

<h2><a name='sampleTrans'>A Sample Transcript</a></h2>

<p><pre>
<a name='r1'>Welcome to the TADS 3 Starter Game!</a>   <a href='#showintro'>[1]</a>

<b><a name='r2'>Box Room</a></b>   <a href=#roomname>[2]</a>
This large box room is strewn with junk. The only way out is via a door to the east.   <a href=#roomdesc>[3]</a>

A small square table stands in the middle of the room.   <a href=#specialdesc>[4]<a>

A large red box sits in the corner.   <a href=#specialdesc>[4]<a> 

You see a tennis ball, an old coat, an odd sock, and a small green book here.   <a href=#lister>[5]</a> 
On the small square table is a small blue box.    <a href=#lister>[5]</a>

<b><a name='r6'>&gt;about</a></b>   <a href=#cmdprompt>[6]</a>
This is just a brief demo game to illustrate where various messages come from in TADS 3.   <a href='#about'>[7]</a>
Or you could think of it as a high adventure with deep characterization, a riveting plot, 
and a myriad of amazing puzzles – except that if you do think of it this way you'll be 
sadly disappointed! 

<b><a name='r8'>&gt;credits</a></b>
Put credits for the game here.   <a href='#credits'>[8]</a>

<b>&gt;x table</b>
On the small square table is a small blue box.   <a href=#lister>[5]</a>   

<b><a name='r9'>&gt;x red box</a></b>
It's large, red and box-shaped. It’s closed.   <a href='#openableLister'>[9]</a> 

<b><a name='r10'>&gt;take box</a></b>
Which box do you mean, the small blue box, or the large red box?  <a href='#disambig'>[10]</a>

<b>&gt;red</b>
Taken.   <a href='#defaultResponse'>[11]</a> 

<b>&gt;look in red box</b>
(first opening the large red box)   <a href='#implicit'>[12]</a>
The large red box contains an old teddy bear, a large black torch, and a red lego brick.   <a href=#lister>[5]</a> 

<b>&gt;take torch</b>
Taken.   <a href='#defaultResponse'>[11]</a> 

<b>&gt;drop box</b>
Dropped.   <a href='#defaultResponse'>[11]</a>

<b>&gt;look</b>
<b>Box Room</b>
This large box room is strewn with junk. The only way out is via a door to the east. 

A small square table stands in the middle of the room.   <a href=#specialdesc>[4]<a> 

You see a tennis ball, an old coat, an odd sock, a small green book, and a large 
red box (which contains an old teddy bear and a red lego brick) here. On the small 
square table is a small blue box. 

<b>&gt;x junk</b>
All sorts of stuff, the accumulated detritus of decades, mostly not worth bothering with. 

<b><a name='r12a'>&gt;search junk</a></b>
The junk isn’t important.   <a href='#notImportant'>[12a]</a>

<b><a name='r13'>&gt;take table</a></b>
The small square table is too heavy. <a href='#tooHeavy'>[13]</a>

<b><a name='r14'>&gt;look in blue box</a></b>
(first unlocking the small blue box, then opening it)   <a href='#implicit'>[12]</a>
The small blue box contains three blue crayons (a blue crayon, a yellow crayon,   <a href='#listgroup'>[14]</a> 
and a red crayon). 

<a name='r15'><b>&gt;x book</b></a>
It's a copy of <i>Getting Started in TADS 6</i>. 

<b>&gt;read book</b>
Reading the book brings back happy memories of writing IF in your early twenties.   <a href='#readdesc'>[15]</a>
With TADS 6 all you had to do was fill in a form specifying the genre of the game, 
the names of a few key NPCs, and the median age of the target audience, select a 
plot-type from a drop-down list, and then hit either the “generate two-hour version 
for IF-Comp” button or “generate long version” button, and a bug-free, typo-free 
TADS 6 game would be instantly created for you. Shame so many diehards on 
rec.arts.int-fiction thought this took all the fun out of creating IF.

<b>&gt;wear sock</b>
(first taking the odd sock)   <a href='#implicit'>[12]</a>
Okay, you’re now wearing the odd sock. 

<a name='r16'><b>&gt;wear sock</b></a>
You’re already wearing it.   <a href='#verify'>[16]</a> 

<a name='r17'><b>&gt;i</b></a>
You are carrying a large black torch, and you’re wearing an odd sock.   <a href='#inventory'>[17]</a>

<b>&gt;e</b>
(first opening the door)   <a href='#implicit'>[12]</a>

<a name='r18'><b>Landing</b></a>
Emerging from the box room you find yourself standing at the top of a flight of   <a href='#roomfirst'>[18]</a> 
stairs leading down to the south. 

<b>&gt;look</b>
<b>Landing</b>
A flight of stairs leads down to the south, while a door leads into the box room 
just to the west. 

<a name='r19'><b>&gt;d</b></a>
You walk briskly down the stairs.   <a href='#travelDesc'>[19]</a> 

<a name='r20'><b>Hall (East End)</b></a>
This large hall continues to the west. A flight of stairs leads up to the north. 

You see a rubber duck here. 

The Harold is standing in the hall (west end).   <a href='#remoteactor'>[20]</a>

Mavis is in the hall (west end), sitting on the wooden chair.   <a href='#remoteactor'>[20]</a> 

<a name='r21'><b>&gt;x harold</b></a>
He's about your height and build, and really looks quite a lot like you. Since he's   <a href='#sightSize'>[21]</a>
your twin brother this is not altogether surprising. 

<b>&gt;x mavis</b>
She’s too far away to make out any detail.   <a href='#sightSize'>[21]</a> 

<a name='r22'><b>&gt;x buck</b></a>
The word “buck” is not necessary in this story.   <a href='#oops'>[22]</a> 

(If this was an accidental misspelling, you can correct it by typing OOPS followed by the
corrected word now. Any time the story points out an unknown word, you can correct a
misspelling using OOPS as your next command.) 

<b>&gt;oops duck</b>  
It's yellow. 

<b>&gt;w</b>
<a name='r23'><b>Hall (West End)</b></a>
This large hall continues to the east. A flight of stairs leads down to the south. 

At the far end of the hall, you see a rubber duck.   <a href='#inRoomName'>[23]</a> 

The Harold is standing here.  <a href='#locActor'>[24]</a>

Mavis is sitting on the wooden chair.  <a href='#locActor'>[24]</a> 

<a name='r25'><b>&gt;exits</b></a>
Obvious exits lead south; and east, back to the hall (east end).   <a href='#exits'>[25]</a>

(You can control the exit listings with the EXITS command. EXITS STATUS shows the exit 
list in the status line, EXITS LOOK shows a full exit list in each room description, 
EXITS ON shows both, and EXITS OFF turns off both kinds of exit lists.) 

<a name='r26'><b>&gt;x mavis</b></a>
She's a funny old woman, when all's said and done. She is sitting on the wooden chair.   <a href='#posture'>[26]</a> 
She's rocking back and forth in her chair moaning “Woe!” 

<a name='r27'><b>&gt;ask mavis about mavis</b></a>
The old woman simply rocks back and forth in her chair moaning, “Woe, woe, woe is me!”   <a href='#noResponse'>[27]</a>

<a name='r28'><b>&gt;talk to harold</b></a>
“Hello, Harold!” you say.   <a href='#greeting'>[28]</a>

“Hi there!” he replies. 

(You could ask him about Mavis.)   <a href='#topics'>[29]</a>

<a name='r30'><b>&gt;a mavis</b></a>
“What's up with Mavis?” you ask.   <a href='#asktopic'>[30]</a>

“She's inconsolable – she can't find her favourite photograph of Buster Keaton,” he tells you. 

<a name='r31'><b>&gt;topics</b></a>
You could ask him about the photo.    <a href='#topics2'>[31]</a>

<a name='r32'><b>&gt;a photo</b></a>
“Where did Mavis leave the photo?” you ask.   <a href='#stopEvent'>[32]</a>

“I think it may be in the cellar; but it's dark down there so I couldn't find it,” he tells you. 

<b>&gt;g</b>
“You think Mavis's photo of Buster Keaton may be in the cellar?” you ask.   <a href='#stopEvent'>[32]</a>

“That's right,” he nods, “Be a good fellow and get it for her, her moaning is getting
 on my nerves.” 

<b>&gt;g</b>
“You think Mavis's photo of Buster Keaton may be in the cellar?” you ask.   <a href='#stopEvent'>[32]</a>

“That's right,” he nods, “Be a good fellow and get it for her, her moaning is getting 
on my nerves.” 

<a name='r33'><b>&gt;ask harold about american foreign policy</b></a>
“I think you'd better help poor Mavis before we discuss that,” he suggests.  <a href='#defresponse'>[33]</a> 

<a name='r34'><b>&gt;bye</b></a>
Nothing obvious happens.   <a href='#bye'>[34]</a>

<a name='r35'><b>&gt;d</b></a>
<b>In the dark</b>   <a href='#dark'>[35]</a>
It’s pitch black. 

<a name='r36'><b>&gt;turn on torch</b></a>
Okay, the large black torch is now on.   <a href='#torchon'>[36]</a>   

<b>Cellar</b>   <a href='#nowlight'>[37]</a>
The cellar is almost bare. A flight of stairs leads up to the north. 

You see a photo of Buster Keaton here. 

<b>&gt;x photo</b>
The picture shows Buster Keaton posing in a Confederate uniform in <i>The General</i>. 

<a name='r38'><b>&gt;take it</b></a>
Taken. 
(Your score has just increased by ten points.)   <a href='#score'>[38]</a>
(If you’d prefer not to be notified about score changes in the future, type NOTIFY OFF.) 

<a name='r39'><b>&gt;i</b></a>
You are carrying a large black torch (providing light) and a photo of Buster Keaton,   <a href='#providing'>[39]</a>
and you’re wearing an odd sock. 

<a name='r40'><b>&gt;e</b>
You can’t go that way. The only obvious exit leads north, back to the hall (west end).   <a href='#cantgo'>[40]</a> 

<a name='r41'><b>&gt;turn off torch</b></a>
Okay, the large black torch is now off. 

It is now pitch black.   <a href='#darkannounce'>[41]</a> 

<a name='r42'<b>&gt;e</b></a>
It’s too dark; you can’t see where you’re going.   <a href='#darkgo'>[42]</a>

<a name='r43'><b>&gt;up</b></a>
<b>Hall (West End)</b>
This large hall continues to the east. A flight of stairs leads down to the south. 

At the far end of the hall, you see a rubber duck. 

The Harold is standing here. 

Mavis is sitting on the wooden chair. 

You turn to Mavis and hand her the photograph of Buster Keaton. She snatches it       <a href='#fuse'>[43]</a> 
eagerly from your grasp, instantly stops her moaning, and showers the actor's picture 
with delighted kisses.

(Your score has just increased by ten points.)

*** You have made an old lady very happy ***   <a href='#winning'>[44]</a>

In 42 moves, you have scored 20 of a possible 20 points.   <a href='#finalscore'>[45]</a> 

Would you like to RESTORE a saved position, RESTART the story, UNDO the last move,   <a href='#winning'>[44]</a> 
see your FULL SCORE, or QUIT?

<a name='r46'><b>&gt;full score</b></a>
In 42 moves, you have scored 20 of a possible 20 points. Your score consists of:   <a href='#fullscore'>[46]</a>
	10 points for retrieving the photograph
	10 points for making Mavis happy


Would you like to RESTORE a saved position, RESTART the story, UNDO the last move, 
see your FULL SCORE, or QUIT?

<a name='r47'><b>&gt;q</b></a>
Thanks for playing!   <a href='#goodbye'>[47]</a>
</pre></p>
<br>
<hr>


<h2>Explanations</h2>

<h3><a name=showintro>[1] showIntro()</a></h3>

<p>"Welcome to the TADS 3 Starter Game!" This text is generated from the showIntro() method of <a href=#gameMain>gameMain</a>. This is something you'll normally want to customize.</p>
<a href='#r1'>[back]</a>
<br>
<h3><a name=roomname>[2] roomName</a></h3>

<p>The name of the room printed at the head of its description is taken from the room's 
roomName property. Normally this is assigned through the Room template, as in <a href='boxRoom'>boxRoom</a>, the starting location here.</p>

<p>By default the room name is shown in bold. If you want to change this you can do so by modifying roomnameStyleTag; e.g. to make the room name appear in italics in a fixed-spaced font:</p>

<p><pre>
modify roomnameStyleTag
    openText = '\n&lt;i&gt;&lt;FONT FACE=TADS-TYPEWRITER&gt;'
    closeText = '&lt;/FONT&gt;&lt;/i&gt;\n'
;
</pre></p>

<p>We could similarly modify statusroomStyleTag to change the way the room name is displayed in the status line (although here we would probably override the htmlOpenText and htmlCloseText properties instead.)</p>
<a href='#r2'>[back]</a>
<br>
<h3><a name=roomdesc>[3] Room Description</a></h3>
<p>The normal description of a room is taken from its desc property. Normally this is assigned through the template, as shown in the <a href='#boxRoom'>boxRoom</a> example.</p>
<p>Normally a room's description is diplayed in the standard font for the game. This can be changed by modifying roomdescStyleTag. For example to make room decriptions display in the same colours as the status line you could do this:</p>
<p><pre>
modify roomdescStyleTag
    openText = "&lt;font bgcolor=statusbg color=statustext&gt;"
    closeText = "&lt;/font&gt;"
;
</pre></p>
<p>The fact that you <i>can</i> do this doesn't make it a particularly good idea, however, not least because the room description will then be displayed differently from all the items listed within the room (but perhaps this is what someone, somewhere will want for some mysterious purpose).</p>
<a href='#r2'>[back]</a>
<br>

<h3><a name=specialdesc>[4] specialDesc & initSpecialDesc</a></h3>
<p>Items listed in separate paragraphs, like the <a href='#table'>table</a> and the <a href='#largebox'>large red box</a> here, probably
have either a specialDesc or an initSpecialDesc (the latter applies until the object is moved).
In the example the red box (which can be moved) has an initSpecialDesc and the table
(which can't) simply has a specialDesc. The difference between the table and the red box becomes
more apparent later in the transcript: once the box is taken and dropped again its initSpecialDesc is no longer used, and the box is listed among the other miscellaneous items in the room. The table can't be moved at all, however. </p> 
<a href='#r2'>[back]</a>
<br>

<h3><a name=lister>[5] Lists of Objects</a></h3>
<p>The lists of objects lying on the floor and on the table are automatically generated as part of the room description by lookAroundWithinContents(), which is in turn called by lookAroundWithin(), in turn called by lookAround() or lookAroundPov(), all defined on Thing but called on the room in question. These are fairly complex methods that you probably won't want to mess with too much. If you want to change the way lists are displayed, see the Technical Article on <a href='t3Lister.htm'>Lists and Listers</a>.</p>
<a href='#r2'>[back]</a>
<br> 

<h3><a name=cmdprompt>[6] Command Prompt</a></h3>
<p>Many, perhaps most, games don't bother to customize the command prompt, but if you're looking to do so it may help to know that it's generated by libMessages.mainCommandPrompt(which). So if you did want to change it, you could do something like this (though preferably in better taste):</p>

<p><pre>
modify libMessages
    mainCommandPrompt(which)
    {
        "\b&lt;b&gt;&lt;FONT COLOR=RED&gt;What next?&lt;/FONT&gt;&lt;/b&gt; ";
    }
;
</pre></p>

<p>By default what the player types is then displayed in bold black type (with the standard black on white display &mdash; with other colour schemes this may differ). This may be customised in two different places. One way would be to modify InputDef. For example, to make the player's input appear simply in italics we could use:</p>

<p><pre>
modify InputDef
    beginInputFont() { "&lt;i&gt;"; }    
    endInputFont() { "&lt;/i&gt;"; }
;
</pre></p>
<p>Alternatively, we could modify inputlineStyleTag; e.g. to make what the player types appear in bold green print we could do this:</p>

<p><pre>
modify inputlineStyleTag
    htmlOpenText = '&lt;b&gt;&lt;font color=green&gt;'
    htmlCloseText = '&lt;/font&lt;/b&gt;' 
;
</pre></p>
<p>Some caution is needed doing this kind of thing, however, since what might look well enough on your interpreter with the set of colours you're using might look quite dreadful, or even barely visible, on a different interpreter using a different colour scheme.</p>
<p>Note also that the default behaviour of InputDef.beginInputFont() and InputDef.endInputFont() is simply to invoke the opening and closing text of the inputLineStyleTag &mdash; so there's no point trying to modify the input font in both places (any changes to InputDef will take precedence).</p>
<a href='#r6'>[back]</a>
<br>

<h3><a name='about'>[7] About Text</a></h3>
<p>The game's ABOUT text, which has been customized here, is defined in the showAbout() method of the <a href='#versionInfo'>versionInfo</a> object. In a more complex game this might launch a menu offering different kinds of information about the game; here just a simple message is displayed. This is something you will always want to customize in your own games.</p>
<a href='#r6'>[back]</a>
<br>

<h3><a name='credits'>[8] Credits</a></h3>
<p>Although it probably should have been, the credits information for this game has not been customised. The place to do this is in the showCredit() method of the the <a href='#versionInfo'>versionInfo</a> object.</p>
<a href='#r8'>[back]</a>
<br>
<h3><a name='#openableLister'>[9] OpenableContentsLister</a></h3>
<p>The text "It's large, red and box-shaped" simply comes from the desc property of the <a href='#largeBox'>largeBox</a> object. Less obvious, but often more vexing, is the "It's closed" message that comes after it. Ultimately, this comes from <a href='t3lister.htm#openable'>openableContentsLister</a>, and if you want to change this message drastically, or banish it altogether, this might be the best place to attack it. For less drastic changes you can override the openStatus() method on the object in question (in this instance the large red box) or simply the openDesc property. The openDesc() method must return a complete sentence, without any closing spacing or punctuation, such as "it's closed" or "it's open"; openDesc just returns an appropriate adjective or adjectival phrase such as 'open' or 'closed'.</p>
<p>For further ideas on how to deal with 'open' and 'closed' messages, see the appropriate section of the article on <a href='t3banish.htm#open'>Banishing Awkward Messages</a>.</p>
<a href='#r9'>[back]</a>
<br>

<h3><a name='#disambig'>[10] Disambiguation Prompt</a></h3>
<p>This disambiguation prompt is being displayed because there's more than one object in scope that matches the noun 'box', in this case the <a href='#largeBox'>large red box</a> and the <a href='#smallBox'>small blue box</a>. The two boxes have quite distinct names, so that it's no trouble for the player to select one or the other (as in the next command). The parser uses the disambigName property of the objects concerned to list the objects the player is to choose from in a disambiguation prompt. By default, the disambigName is the same as the name. In special cases you might want to override disambigName to give distinct names for disambiguation purposes for objects you otherwise want to be named alike.</p>

<p>It's unlikely that you'll often want to override this disambiguation method, but if you do you'll find it's defined in playerMessages.askDisambig(), in msg_neu.t.</p>
<a href='#r10'>[back]</a>
<br>

<h3><a name='#defaultResponse'>[11] Default Action Report</a></h3>
<p>Laconic messages like 'Done' or 'Taken' or 'Dropped' are generally produced by defaultReport() macros in the action methods for the appropriate actions defined on Thing. For further details of this see the <a href='t3res.htm#action'>Action</a> section of the article on <a href't3res.htm'>Action Results.</a></p>
<p>To change this on an individual object, simply override the appropriate action method on the object in question, calling its inherited handling and then adding your own custom message: e.g.</p>

<p><pre>
vase: Thing 'delicate antique vase' 'antique vase'
   "It looks incredibly delicate. "
   dobjFor(Drop)
   {
	   action()
	   {
		   inherited;
		   "You put the vase down very carefully. ";
	   }
   }
;
</pre></p>

<p>Your custom message will automatically displace anything produce by a defaultReport() macro, so you don't have to worry about both messages appearing. What may be trickier is ensuring that your custom message isn't displayed in the event of an <a href='#implicit'>implicit action</a>; you may need to do something like this to prevent that:</p>

<p><pre>
vase: Thing 'delicate antique vase' 'antique vase'
   "It looks incredibly delicate. "
   dobjFor(Take)
   {
	   action()
	   {
		   inherited;
		   if(!gAction.isImplicit)
		      "You pick the vase up very carefully. ";
	   }
   }
;
</pre></p>
<p>If you want to make a global change, e.g. from the laconic "Dropped" to the slightly less laconic "You put it down", you can either use the above technique to modify Thing appropriately, or else modify the message used by the library. If you search for the laconic "Dropped" message in msg_neu.t, for example, you'll find it's defined on playerActionMessages as:</p>

<p><pre>
     okayDropMsg = 'Dropped. '
</pre></p>

<p>So you could change it with:</p>
<p><pre>
modify playerActionMessages
    okayDropMsg = '{You/he} put{s} {it dobj/him} down. '
;
</pre></p>
<p>You may find this a more convenient way to change several such message globally, not least because the suppression of these default messages in the case of implicit actions is then already taken care of for you. You can also do this on individual objects, if you wish;
   for example, instead of the vase code shown above, you could just define:</p>
<p><pre>
vase: Thing 'delicate antique vase' 'antique vase'
   "It looks incredibly delicate. "
   okayDropMsg = 'You put the vase down very carefully. '
   okayTakeMsg = 'You pick the vase up very carefully. '
;
</pre></p>

<p>
<a href='#r10'>[back]</a></p>
<br>

<h3><a name='implicit'>[12] Implicit Action Announcements</a></h3>
<p>Messages like "(first opening the large red box)" or "(first opening the door)" are implicit action announcements. That is they are messages from the parser telling the player that the parser has just carried out one or more commands on the player's behalf; these commands will generally have been executed in order to enable the command the player actually typed to be carried out. For example, in order to look inside the large red box it's necessary to open the red box, and in order to go through the door it's first necessary to open the door.</p>

<p>In a typical TADS 3 game most implicit actions will be generated by <a href='t3res.htm#precond'>preconditions</a>, such as objOpen. If you want to customize these implicit action reports, see the article on <a href='t3imp_action.htm'>Implicit Action Reports</a> later in this Technical Manual.</p>
<br>

<h3><a name='notImportant'>[12a] Not Important Message</a></h3>
<p>The <a=href='#junk'>junk</a> object is evidentally a Decoration. What's displayed here is a Decoration's default 'not important' message. This can be changed by overriding notImportantMsg on individual Decorations (or on Decoration itself, if so desired).</p>
<a href='#r12a'>[back]</a>
<br>

<h3><a name='tooHeavy'>[13] Too Heavy Message</a></h3>
<p>The <a href='#table'>table</a> has evidently been defined of class Heavy, since this is the standard message that is displayed when a player tries to take or move an object of that class. Such messages are generated from either action() or <a href='t3res.htm#check'>check()</a>, depending on the action in question, but to change them you simply need to override cannotTakeMsg, cannotMoveMsg, and/or cannotPutMsg on the object in question (or the class). By default all these three are the same ("The X is too heavy. ") for a Heavy object.</p>
<a href='#r13'>[back]</a>
<br>

<h3><a name='listgroup'>[14] List Group</a></h3>
<p>In this case, the three similar crayons have been grouped together, using the crayonGroup ListGroup used in the listWith property of the <a href='#crayon'>Crayon</a> class. The effect is somewhat spoiled, however, because the job hasn't been done properly: the three crayons are introduced as "three blue crayons" instead of just "three crayons". This could be fixed by overriding showGroupCountName() on crayonGroup:</p>

<p><pre>
crayonGroup: ListGroupParen
    showGroupCountName(lst)
    {
        "&lt;&lt;spellInt(lst.length())&gt;&gt; crayons";
    }
;
</pre></p>

<p>For more details about using ListGroups, see the section on <a href='t3lister.htm#grouping'>Grouping</a> in the article on <a href='t3lister.htm'>Lists and Listers</a>.</p>
<a href='#r14'>[back]</a>
<br>

<h3><a name='readdesc'>[15] readDesc</a></h3>

<p>You'll notice that X BOOK and READ BOOK give different responses here (which is not the case for most objects). That's because the <a href='#greenBook'>green book</a> has been made of class Readable and given a separate readDesc property.</p>
<a href='#r15'>[back]</a>
<br>

<h3><a name='verify'>[16] Verify Message</a></h3>
<p>The first time the player types WEAR SOCK the parser is quite happy to carry out the command, since the <a href='#sock'>sock</a> is both within scope and defined as being a Wearable. On the second occasion, however, the parser complains that the sock is already being worn; this type of message, where an action is not (or is not yet or is no longer) reasonable is typically generated by a <a href='t3res.htm#verify'>verify routine</a>.</p>
<a href='#r16'>[back]</a>
<br>

<h3><a name='inventory'>[17] Inventory Listing</a></h3>
<p>This is a typical <a href='t3lister.htm#inventory'>inventory listing</a>. 
<a href='#r17'>[back]</a>
<br>

<h3><a name='roomfirst'>[18] roomFirstDesc</a></h3>
<p>Ordinarily it would be a bad idea to include any mention of how you arrived at the location in a room descrption, since this will generally not read well if the room is approached from some other direction, or the room is subsequently examined again. In this case, however, the <a href='#landing'>landing</a> is described differently when it is examined the second time. This is achieved by using roomFirstDesc to display a different description the first time the room is examined. This works well here since the first time the landing is examined the player character <i>can</i> only have just entered it from the box room.</p>
<a href='#r18'>[back]</a>
<br>

<h3><a name='travelDesc'>[19] travelDesc</a></h3>
<p>There's more than one way we could produce this description of the player character walking down the stairs. Perhaps the simplest, which is used the code below, is to make the <a href='#stairway'>stairway</a> a TravelWithMessage as well as a StairwayDown and then simply define the message we want on its travelDesc property.</p>
<a href='#r19'>[back]</a>
<br>
<h3><a name='remoteactor'>[20] Remotely Described Actors</a></h3>

<p>The hall is represented in this game by two different locations, <a href='#hallEast'>hallEast</a> and <a href='#hallWest'>hallWest</a>, linked with a <a href='#dConn'>DistanceConnector</a>. The implementation is less than perfect, however, as can be seen from the transcript.</p>

<p>The man is described with the text:</p>

<p><pre>
The Harold is standing in the hall (west end).
</pre></p>

<p>Obviously he should be described as 'Harold' not 'the Harold'. What's needed to fix this is to add:</p>

<p><pre>
    isProperName = true
</pre></p>
<p>to the definition of the <a href='#harold'>harold</a> object.</p>

<p>A second infelicity is the fact that both Harold and Mavis are described as being "in the wall (west end)"; while it is probably clear enough what this means, it would read better if they were said to be "in the east end of the hall" or even better, perhaps, "at the other end of the hall". One way of achieving the latter, using inRoomName(), is illustrated below. A second way to deal with this would be to explicitly assign the name property of hallWest, which, using the template, would mean giving it an explicit destName as well, like this:</p>

<p><pre>
hallWest: Room 'Hall (West End)' 'the west end of the hall' 
    'west end of the hall'
    "This large hall continues to the east. A flight of stairs leads down to the
    south. "
    ...
;
</pre></p>

<p>Here the first single-quoted string in the Room template is the roomName, which is displayed in the status line and at the head of a room description. The second single-quoted string is the destName, used in exit listings. The third single-quoted string defines the name property, which is the one that concerns us here. Changing the name property in this way would result in this output:</p>
<p><pre>
<b>Hall (East End)</b>
This large hall continues to the west. A flight of stairs leads up to the north. 

You see a rubber duck here. 

The Harold is standing in the west end of the hall. 

Mavis is in the west end of the hall, sitting on the wooden chair. 
</pre></p>

<p>Another way we could change this is by defining an actorInName on westHall. For example we could define:</p>

<p><pre>
    actorInName = 'at the far end of the hall'
</pre></p>
<p>This would then give us:</p>
<p><pre>
<b>Hall (East End)</b>
This large hall continues to the west. A flight of stairs leads up to the north. 

You see a rubber duck here. 

The Harold is standing at the far end of the hall. 

Mavis is at the far end of the hall, sitting on the wooden chair. 
</pre></p>
<p>We have yet to go into what part of the code is generating the messages that Harold is standing while Mavis is sitting on the wooden chair; we'll discuss this in more detail <a href='#locActor'>below</a> when we talk about how Harold and Mavis are listed in their own room description. But we'll make a brief foray into it here, insofar as it's relevant to listing actors specifically in <i>remote</i> locations, as here. Suppose we thought it would be neater to have Mavis listed as "Mavis is sitting on the wooden chair at the far end of the hall." We can override the way an actor is listed by overriding the specialDesc property on their current ActorState, or, in a case such as this, where we're viewing the actor from a remote location, by overriding the remoteSpecialDesc(pov) method (where the pov parameter is the point of view from which we're looking, normally that of the player character). </p>

<p><a href='#mavis'>Mavis</a> starts out in a <a href='#hermit'>HermitActorState</a> (for details of ActorStates see the article on <a href='t3actor.htm'>Creating Dynamic Characters</a>). All we need to do is to add the following to the definition of this HermitActorState:</p>
<p><pre>
    remoteSpecialDesc(pov)
    {
        "Mavis is sitting on the wooden chair at the far end of the hall. ";
    }
</pre></p>
<p>Then we'll get:</p>
<p><pre>
<b>Hall (East End)</b>
This large hall continues to the west. A flight of stairs leads up to the north. 

You see a rubber duck here. 

The Harold is standing at the far end of the hall. 

Mavis is sitting on the wooden chair at the far end of the hall. 
</pre></p>
<a href='#r20'>[back]</a>
<br>

<h3><a name='sightSize'>[21] Remote Descriptions and sightSize</a></h3>
<p>It shouldn't be too difficult to see where the description of Harold is coming from; it's simply the desc property defined on the <a href='#harold'>harold</a> object. But why aren't we seeing a description for <a href='#mavis'>Mavis</a>?</p>
<p>The answer is quite simple: the game defines <code>sightSize = large</code> on Harold (which means we can get a description of him from a distance, including from a remote location, as here), but we have omitted to make the same change on Mavis. Mavis's sightSize is thus still at medium (the default), which means that although she can be seen from a distance, any attempt to view her from a remote location will be met with the response "She’s too far away to make out any detail."</p>
<p>If we want to change this we have several options, depending on what we want to achieve.</p>
<p>First, we could just define <code>sightSize = large</code> on Mavis as well as Harold, so that we'd get her normal description too.</p>
<p>Second, if we're happy that Mavis is too small to be clearly discerned from a distance, but we want to customize the message that's shown in such circumstances, we could modify the library method that produces it, namely libMessages.distantThingDesc(obj); e.g.:<p>
<p><pre>
modify libMessages
    distantThingDesc(obj)
    {
        gMessageParams(obj);
        "You haven't got your glasses on, so you can't really out much of {the
        obj/him} from this distance. ";
    }
;
</pre></p>
<p>An alternative place to customize this message is on Thing.defaultDistantDesc(), so instead of the above we could do the following, with much the same effect:</p>
<p><pre>
modify Thing
    defaultDistantDesc()
    {
        "You haven't got your glasses on, so you can't really out much of
        &lt;&lt;theName&gt;&gt; from this distance. ";
    }
;
</pre></p>
<p>This second method has the advantage of being a bit simpler and more direct, and also more flexible, since you could also modify defaultDistantDesc() on individual objects or classes, customizing this message as seems most appropriate to the objects it applies to.</p>

<p>The third possibility is to override remoteDesc(pov) on Mavis, which will define how she's described from a remote point of view regardless of her sight size. For example:</q>
<p><pre>
mavis: Person 'old mavis/woman' 'Mavis' @woodenChair
    "She's a funny old woman, when all's said and done. "
    remoteDesc(pov)  {  "She's quite aged. "; }
    isProperName = true
    isHer = true
    posture = sitting
;
</pre></p>
<p>This would give us (when carried out in the east end of the hall):<p>
<p><pre>
<b>&gt;x mavis</b>
She's quite aged. 
</pre></p>
<a href='#r21'>[back]</a>
<br>
<h3><a name='oops'>[22] Oops</a></h3>
<p>The first part of the message, saying that word "buck" (presumably a typo for "duck" here) is not necessary in the game (meaning that the game doesn't recognize it), comes from player.messages.AskUnknownWord(). The second half (which would only be displayed the first time an unknown rord is encountered) comes from libMessages.oopsNote() (which playerMessages.askUnknownWord() calls).</p>
<p>For a slightly fuller explanation of how these messages are reached, see the section on <a href='t3cycle.htm#parsing'>Parsing the Player's Command</a> in the article on the Command Execution Cycle.</p>
<a href='#r22'>[back]</a>
<br>

<h3><a name='inRoomName'>[23] inRoomName</a></h3>
<p>The rubber duck is sensibly described as being "At the far end of the hall". This is because <a href='#hallEast'>hallEast</a> defines inRoomName() accordingly; the inRoomName(pov) method can be used to define a prepositional phrase (e.g. "at the far end of the hall", "further up the street" or "in the north side of the field") used to describe the whereabouts of objects in this location when they're viewed from another location. The point-of-view parameter (pov) can be used to vary this phrase according to where we're looking from; we could, for example, check <code>pov.getOutermostRoom</code> to decide whether to describe a particular stretch of street as "further up the street to the north" or "further down the street to the south".</p>
<p>In this case, since the east end of the hall can only be viewed from one other location, namely the west end of the hall, we could have used actorInName to the same effect:</p>
<p><pre>
hallEast: Room 'Hall (East End)' 
    "This large hall continues to the west. A flight of stairs leads up to the
    north. "
    actorInName = 'at the far end of the hall'
    north = hallStairs
    up asExit(north)
    west = hallWest       
;
</pre></p>
<a href='#r23'>[back]</a>
<br>

<h3><a name='locActor'>[24] Listing Local Actors</a></h3>
<p>Here <a href='#harold'>Harold</a> and <a href='#mavis'>Mavis</a> are shown in the standard form for listing actors who are present in the player character's location (rather than actors in a remote location, as we discussed above). Tracing where the library actually generates these descriptions is a little complex; here's the chain:</p>
<ol>
<li>In the first instance, the way an actor is listed in a room is determined by that actor's specialDesc (or distantSpecialDesc or remoteSpecialDesc). It can therefore be directly overridden here, but the standard library behaviour is to call the corresponding method on the actor's current ActorState, (e.g. Actor.specialDesc is defined as <code>specialDesc() { curState.specialDesc(); }</code>). Unless the actor will never change ActorStates during the course of the game it's generally a good idea not to override specialDesc directly on the actor.</li>
<li>By default, ActorState.specialDesc() in turn calls the actorHereDesc() method on the actor (distantSpecialDesc and remoteSpecialDesc both call actorThereDesc on the actor). This is usually a good point to intervene; if you want to change the way an actor is listed in a room description override specialDesc() (or distantSpecialDesc or remoteSpecialDesc) on the ActorState.</li>
<li>If specialDesc has not been overridden on the ActorState, it's routed back to Actor.actorHereDesc. This is turn calls descViaActorContainer (again on the actor). More specifically, actorHereDesc calls <code>descViaActorContainer(&roomActorHereDesc, nil);</code> while actorThereDesc calls <code>descViaActorContainer(&roomActorThereDesc, nil);</code></li>
<li>What Actor.descViaActorContainer does is a little hard to describe. Basically it first determines whether the actor's container needs to be explicitly mentioned (as in the case of the chair Mavis is sitting on) or not (as in the case of Harold, who is standing directly in the room that's being described). In the first case it then calls a property of the container; in the second it calls a property of the gLibMessages object. The property it calls is determined by the first parameter passed to descViaActorContainer. In this case, that property is roomActorHereDesc (passed by actorHereDesc in the previous step). For Mavis, this will result in roomActorHereDesc() being called on the chair; for Harold this will result in roomActorHereDesc() being called on libMessages.</li>
<li>For Harold, we reach the end of the chain at libMessages.roomActorHereDesc(actor), which, by default, generates the message "\^&lt;&lt;actor.nameIs&gt;&gt; &lt;&lt;actor.posture.participle&gt;&gt; &lt;&lt;tSel('here', 'there')&gt;&gt;. ", which in this case translates into "Harold is standing here."</li> 
<li>For Mavis, the chain continues with a call to roomActorHereDesc(actor) on the object she's sitting upon. By default this will inherit from BasicLocation.roomActorHereDesc(actor), which calls gLibMessages.actorInRoom(actor, self); </li>
<li>For Mavis, the chain thus finally comes to an end at libMessages.actorInRoom(actor, cont), with Mavis being passed as the actor parameter and the chair as the cont parameter. By default this displays the message "\^&lt;&lt;actor.nameIs&gt;&gt; &lt;&lt;actor.posture.participle&gt;&gt; &lt;&lt;cont.actorInName&gt;&gt;. ", which in this case translates into "Mavis is sitting on the wooden chair. "</li>
</ol>

<p>For most purposes, this is probably more detail than we really need to know. It's conceivably useful to intervene at any point in this chain; for example we might want to override roomActorHereDesc() on a particular object to customize the way any actor within that object is described (e.g. "Wilbur is perched precariously on the narrow rail", when you'd want the "perched precariously..." bit shown whoever was sitting on the narrow rail). In the vast majority of cases, however, you'll probably want to stick to overriding the specialDesc property of the relevant ActorState. For example we could override the specialDescs on <a href='#harold'>Harold's</a> initial ActorState and <a href='#mavis'>Mavis's</a> thus:</p>
<p><pre>
mavis: Person 'old mavis/woman' 'Mavis' @woodenChair
    "She's a funny old woman, when all's said and done. "
    isProperName = true
    isHer = true
    posture = sitting
;

+ HermitActorState
    isInitState = true
    noResponse = "The old woman simply rocks back and forth in her chair
        moaning, &lt;q&gt;Woe, woe, woe is me!&lt;/q&gt;"
    stateDesc = "She's rocking back and forth in her chair moaning &lt;q&gt;Woe!&lt;/q&gt; "
    specialDesc = "Mavis is slumped miserably in the wooden chair. "
;

harold: Person 'twin man/harold/brother' 'Harold' @hallWest
    "He's about your height and build, and really looks quite a lot like you.
    Since he's your twin brother this is not altogether surprising. "
    sightSize = large
    isHim = true
;

+ hTalking: InConversationState
    specialDesc = "Harold is standing by Mavis\'s chair, waiting for you to
        speak. "
    
;
</pre></p>
<p>To produce:</p>
<p><pre>
<b>Hall (West End)</b>
This large hall continues to the east. A flight of stairs leads down to the south. 

At the far end of the hall, you see a rubber duck. 

Harold is hovering anxiously over Mavis. 

Mavis is slumped miserably in the wooden chair. 
</pre></p>

<a href='#r23'>[back]</a>
<br>

<h3><a name='exits'>[25] Listing Exits - destName</a></h3>
<p>First, the news in brief: the list of exits is produced by exitLister.showExitsCommand(), which in turn calls chain of methods too complex to go into here. Suffice to say that if you want to customize the way exits are listed, that's the place to look. It's also exitLister.showExitsCommand() that's responsible for displaying the explanation of the EXITS command ("You can control the exit listings with the EXITS command. EXITS STATUS ...") the first time it's used. The easiest way to suppress this altogther would be to set exitLister.exitsOnOffExplained to true at the start of the game. If you want a different explanation explained it's probably easiest to override exitLister.showExitsCommand to display your own version, but you could instead override libMessages.explainExitsOnOff.</p>

<p>The more noteworthy point here, however, is that the exit listing in the transcript appears slighly clumsy: "Obvious exits lead south; and east, back to the hall (east end)." It would read better if it ended with "back to the east end of the hall." To do that we simply need to define a destName on <a href='#hallEast'>hallEast</a>:</p>

<p><pre>
hallEast: Room 'Hall (East End)' 'the east end of the hall'
    "This large hall continues to the west. A flight of stairs leads up to the
    north. "    
    actorInName = 'at the far end of the hall'
    north = hallStairs
    up asExit(north)
    west = hallWest       
;
</pre></p>
<p>Here the destName is defined by including it as the second single-quoted string in the template. It's usually a good idea to do this any time when 'the' followed by the roomName (the first single-quoted string) would look clumsy in a list of exits.</p>
<a href='#r25'>[back]</a>
<br>

<h3><a name='posture'>[26] Actor Posture</a></h3>
<p>The description of Mavis seems a little clumsy here, since it refers to the chair twice, first in the sentence "She is sitting on the wooden chair" and then immediately afterwards in the sentence "She's rocking back and forth in her chair moaning “Woe!”" The first of these two sentences looks redundant here; but where is it coming from, and how do we get rid of it?</p>
<p>There are actually three sentences describing Mavis here. The first, "She's a funny old woman, when all's said and done" comes from the desc property of the <a href='#mavis'>mavis</a> object. The last, "She's rocking back and forth in her chair moaning “Woe!”", comes from the stateDesc of the <a href='#hermit'>HermitActorState</a> that Mavis starts out in (if you need an explanation of ActorStates, see the article on <a href='t3Actor.htm'>Creating Dynamic Characters</a>). It's the troublesome middle sentence that appears to come from nowhere in the author's code.</p>

<p>It may be helpful to explain the chain of events that produces this message:</p>
<ol>
<li>Examining an object is carried out by the basicExamine() method on that object (defined on Thing). Once that routine has displayed the appropriate description (normally, and in this case, from the desc property) it goes on to call examineStatus() in order to provide any additional information that's appropriate to the particular state the object is in.</li>
<li>On an actor, examineStatus() first calls postureDesc() on the current actor (unless the current actor is the player character) and only then calls stateDesc on the current actor state.</li>
<li>In turn, Actor.postureDesc() calls descViaActorContainer(&roomActorPostureDesc, nil), again on the current actor.</li>
<li>Actor.descViaActorContainer() then calls roomActorPostureDesc on the actor's container (except under particular circumstances when it's called on libMessages instead).</li>
<li>By default, the container uses BasicLocation.roomActorPostureDesc, which then in turn calls gLibMessages.actorInRoomPosture(actor, self) (gLibMessages is normally just libMessages).</li>
<li>Finally, libMessages.actorInRoomPosture(actor, room) produces the message "\^&lt;&lt;actor.itIs&gt;&gt; &lt;&lt;actor.posture.participle&gt;&gt; &lt;&lt;room.actorInName&gt;&gt;", which in this case translates into "She is sitting on the wooden chair."</li>
</ol>
<p>Although we could in principle intervene at any stage in the process, the best place for this kind of situation is commonly in Mavis's postureDesc() method. To suppress the unwanted redundancy we can simply make it do nothing at all:</p>
<p><pre>
mavis: Person 'old mavis/woman' 'Mavis' @woodenChair
    "She's a funny old woman, when all's said and done. "
    postureDesc = ""
    isProperName = true
    isHer = true
    posture = sitting
;
</pre></p>
<p>Then we'll get:</p>
<p><pre>
>x mavis
She's a funny old woman, when all's said and done. She's rocking back and forth 
in her chair moaning “Woe!” 
</pre></p>
<p>In this case, that's all we need to do, since Mavis never moves from her chair, and never changes ActorState. In a more complex situation we might want postureDesc() to do its usual stuff in some situations but not in others; in that case we might need to build in an appropriate test, e.g.:</p>

<p><pre>
   postureDesc()
   {
	   if(curState not in (mavisSitting, mavisWandering))
	      inherited;	   
   }
</pre></p>

<p>This would give us the default description of Mavis's posture except when she's in either the MavisSitting or the MavisWandering states (which, it is to be assumed, already describe Mavis's posture sufficiently well in their stateDescs). A more general solution might be to modify Actor and ActorState thus:</p>

<p><pre>
modify Actor()
	postureDesc()
	{
		if(!curState.describesPosture)
		   inherited;
	}
;

modify ActorState
	describesPosture = nil
;
</pre></p>
<p>Then all we'd need to do is to define describesPosture = true on any ActorState where the stateDesc already gives an adequate account of the posture (so that the message produced by the standard postureDesc would seem redundant).</p>

<p>For further information on taming posture messages, see the section on Unwanted Postures in the article on <a href='t3banish.htm#posture'>Banishing Awkward Messages</a>.</p>

<a href='#r26'>[back]</a>
<br>

<h3><a name='noResponse'>[27] HermitActorState.noResponse</a></h3>

<p>There are several ways in which Mavis's response, or rather non-response - could have been generated here, but given the nature of her (non-)response and the absence of any greeting protocols, the most likely (and most probable) way this has been generated is from the noResponse property of a <a href='#hermit'>HermitActorState</a>.</p>

<a href='#r27'>[back]</a>
<br>

<h3><a name='greeting'>[28] HelloTopic</a></h3>

<p><a href='#harold'>Harold</a> responds to the player character's greeting here because he's been given an explicit HelloTopic in his initially active ConversationReadyState. For a fuller explanation of these terms see the article on <a href='t3conv.htm'>Programming Conversations with NPCs</a>.</p>

<a href='#r28'>[back]</a>
<br>

<h3><a name='topics'>[29] Suggested Topics</a></h3>
<p>The explicit greeting command has resulted in a list of topics the player could try asking <a href='#harold'>Harold</a> about (here there's actually only one). The greeting triggers a call to suggestTopics(true) on the actor initiating the conversation (in this case, and in most others, the player character); it's the 'explicit' argument that's being called as true here. The suggestTopics method then calls suggestTopicsFor(self, explicit) on the actor who his being addressed (in this case Harold), which in turn calls suggestTopicsFor() on that actor's current ActorState (which should by now be Harold's InConversationState). This then calls the ActorState's showSuggestedTopics() method.</p>

<p>Here, Mavis is listed as a possible topic of conversation because there's a currently active <a href='#mavisask'>AskTopic<a> for mavis that's also a SuggestedAskTopic. There's also an AskTopic for the <a href='#photoask'>photo</a> that's a SuggestedAskTopic, but that's not active yet since at this stage the player character doesn't know about the photo.</p>

<p>For a fuller explanation of all this see the article on <a href='t3conv.htm'>Programming Conversations with NPCs</a>.</p>
<a href='#r28'>[back]</a>
<br>

<h3><a name='asktopic'>[30] AskTopic</a></h3>
<p>Here we see a fairly standard kind of response from an <a href='#mavisask'>AskTopic<a>. This one informs the player character about the photograph and so needs to mark that object as known about so that the player can now refer to it in subsequent conversation. At the same time the player's curiosity about Mavis is exausted (that is, she won't appear as a suggested topic of conversation again.</p>

<p>For a fuller explanation of all this see the article on <a href='t3conv.htm'>Programming Conversations with NPCs</a>.</p>
<a href='#r30'>[back]</a>
<br>

<h3><a name='topics2'>[31] Explicit Topic Request</a></h3>
<p>We have just met a topic inventory display <a href='#topics'>above</a>. The procedure for producing it is much the same here, except that the output is not enclosed in parentheses (since it's the response to an explicit TOPICS command, not a by-product of a greetings command). One point to note is that the list has changed: the player character's curiosity about Mavis has been exhausted, but he now knows about the photograph, so that has become available to be asked about.</p>
<a href='#r30'>[back]</a>
<br>

<h3><a name='stopEvent'>[32] StopEventList</a></h3>
<p>Once again we see the output from an ordinary AskTopic, but this one appears also to be a <a href='#photoask'>StopEventList</a>, since we get a different response second time round, which repeats thereafter.</p>

<a href='#r32'>[back]</a>
<br>

<h3><a name='defresponse'>[33] DefaultTopic</a></h3>
<p>The player is always likely to ask an NPC about topics for which the author has provided no specific response, as here. At least we can assume that the author of this game would not have thought to provide a response to asking Harold about American foreign policy, so this will almost certainly be the response from some kind of <a href='#deftopic'>DefaultTopic</a>. This one has the merit of keeping the player firmly focused on his next objective.</p>

<p>For more information on how DefaultTopics can be used in NPC conversations, see the article on <a href='t3conv.htm'>Programming Conversations with NPCs</a>.</p>
<a href='#r33'>[back]</a>
<br>

<h3><a name='bye'>[34] Missing ByeTopic</a></h3>
<p>The unfortunate "Nothing happens." response occurs here because the author has forgotten to define an appropriate ByeTopic for Harold at this point. We need to add something like the following (after the HelloTopic in Harold's <a href='#hWaiting'>ConversationReadyState</a>:</p>
<p><pre>
+++ ByeTopic
    "&lt;q&gt;Bye for now,&lt;/q&gt; you say.\b
    &lt;q&gt;See you soon,&lt;/q&gt; he replies. "
;
</pre></p>
<p>We'd then see:</p>
<p><pre>
<b>&gt;bye</b>
“Bye for now,” you say.

“See you soon,” he replies. 
</pre></p>

<p>For a more sophisticated implementation, we might want to provide a separate ImpByeTopic, LeaveByeTopic and so forth.</p>
<a href='#r34'>[back]</a>
<br>
<h3><a name='dark'>[35] Darkness</a></h3>
<p>There are two library default messages here, which we may as well take together. The first, 'In the dark', is the default value of roomDarkName. The second "It's pitch black" is likewise the default value of roomDarkDesc. These give respectively the name and the description of a location when there's not enough light present to see it by.</p>

<p>It's easy enough to customize both messages when appropriate, as it probably is here, since the player character is presumably at least aware that the stairs lead down into the cellar. So we might change the definition of the <a href='#cellar'>cellar</a> location thus:</p>

<p><pre>
cellar: DarkRoom 'Cellar'
    "The cellar is almost bare. A flight of stairs leads up to the north. "
    roomDarkName = 'Cellar (in the dark)'
    roomDarkDesc = "You're dimly aware of the flight of stairs leading back up,
        but otherwise it's too dark to see anything in here. "
    north = cellarStairs
    up asExit(north)    
;
</pre></p>
<p>We'd then get:</p
<p><pre>
<b>&gt;d</b>
<b>Cellar (in the dark)</b>
You're dimly aware of the flight of stairs leading back up, but otherwise it's 
too dark to see anything in here. 
</pre></p>
<p>Since the dark description now mentions the flight of stairs, it might be a good idea to give the stairs object a brightness of 1, so that the flight of stairs can be referred to by the player (e.g. CLIMB STAIRS) even in the absence of light.</p>

<a href='#r35'>[back]</a>
<br>

<h3><a name='torchon'>[36] Torch Turned On Message</a></h3>
<p>This is simply the default message for turning something on, generated from actionDobjTurnOn(). The actual message used is playerActionMessages.okayTurnOnMsg. If you wanted to customize it for a particular Flashlight you'd probably do so in its actionDobjTurnOn() method, i.e. the action part of dobjFor(TurnOn).</p>

<a href='#r36'>[back]</a>
<br>

<h3><a name='nowlight'>[37] A Newly Lit Location</a></h3>

<p>Turning on the torch also causes the room description to be re-displayed, now that the player character can see it. This is carried out by the special internal action NoteDarkness, which is called from Actor.noteConditionsAfter() if the lighting conditions have changed over the course of the current action. Action.doAction() calls pc.noteConditionsBefore() (pc = player character) at the start of an action (which makes a note of whether it's light or dark) and then calls pc.noteConditionsAfter() near the end of the action to check whether lighting conditions have changed, requiring a new description of the newly-lit location or else an announcement of the onset of darkness.</p>
<a href='#r36'>[back]</a>
<br>

<h3><a name='score'>[38] Score Notification</a></h3>

<p>We get this score notification because actionDobjTake() on the <a href='#photo'>photo</a> object calls awardPointsOnce() on an associated Achievement (a number of other methods might have had a similar effect, but this is the one that was used here).</p>

<p> Whatever the precise method use to invoke the scoring, it will usually be routed through the addToScore() function, which in turn calls libScore.addToScore_() (note the underscore).</p>

<p> The actual message announcing the change in score comes from scoreNotifier.checkNotification(), which uses libMessages.firstScoreChange() if this is the first time a change of score is being notified in a game, or libMessages.scoreChange() thereafter. Both these libMessages methods then call libMessages.basicScoreChange() to announce the actual change in score, but libMessages.firstScoreChange() then goes on to diplay the additional message "(If you’d prefer not to be notified about score changes in the future, type NOTIFY OFF.)"</p>

<a href='#r38'>[back]</a>
<br>

<h3><a name='providing'>[39] State-Related Text</a></h3>

<p>We've already seen an <a href='#inventory'>inventory listing</a> before. What's new here is the text '(providing light)' following the name of the torch in the inventory listing. Without going into arcane details of the way various inventory listers go about their business, we can say that this text ultimately comes from the listName_ property of lightSourceStateOn, so that one way to customize it would be with the following:</p>

<p><pre>
modify lightSourceStateOn
    listName_ = 'currently switched on'    
;
</pre></p>
<p>We'd then see:</p>
<p><pre>
<b>&gt;i</b>
You are carrying a large black torch (currently switched on) and a photo of Buster 
Keaton, and you’re wearing an odd sock.
</pre></p>
<p>This is fine when the torch is the only light source in the game, but if there were multiple light sources it might not be so good, since this change would then apply to all of them. To allow for this we could make the more complicated change:</p>
<p><pre>
modify lightSourceStateOn
    listName(lst) 
    {
        if(lst == [torch])
            return 'currently switched on';
        else
            return inherited(lst);
    }
;
</pre></p>
<p>The change would then apply only to the torch; any other light source would continue to use the default 'providing light' message. If we had multiple light sources all requiring their own versions of this message, we might come up with a different kind of scheme, making the light source supply its own message:</p>

<p><pre>
modify lightSourceStateOn
    listName(lst) 
    {
        if(lst.length() == 1)
            return lst[1].providingLightMsg;
        else
            return inherited(lst);
    }
;

modify LightSource
    providingLightMsg = 'providing light'
;
</pre></p>
<p>One could then override providingLightMsg on each and every light source that required a custom version.</p>
<p>A few more words of explanation may be in order to help make sense of this. A light source can have one of two states, depending whether it is lit or not. These possible states are defined in its allStates property:</p>

<p><pre>
    allStates = [lightSourceStateOn, lightSourceStateOff]
</pre></p>
<p>The current state (given by the getState property) is determined by whether or not the light source is currently lit:</p>
<p><pre>
    getState = (brightness > 1 ? lightSourceStateOn : lightSourceStateOff)
</pre></p>
<p>lightSourceStateOn and lightSourceStateOff are both ThingState objects; these are used both to provide the extra pieces of state-related text (such a 'providing light') and to help the objects they relate to respond to the correct vocabulary (so that a LightSource that's lit can be referred to as 'lit'). The standard library uses ThingStates for light sources (as shown here), Matchsticks (matchStateLit or matchStateUnlit) and Wearables (wornState and unwornState).</p>

<p>For further suggestions on dealing with messages of this sort, see the appropriate section in the article on <a href='t3banish.htm#lit'>Banishing Awkward Messages</a>.</p>

<a href='#r39'>[back]</a>
<br>

<h3><a name='cantgo'>[40] Cannot Go That Way</a> </h3>
<p>This is the message you get when the player character tries to go in an unavailable direction. The message is generated by cannotGoThatWay() (called on the current room), which in turn first displays the room's cannotGoThatWayMsg, and then calls cannotGoShowExits(gActor) to list the exits that are available.</p>

<p>There are thus several places at which you can customize this, but two in particular are useful. If you want to change the first part of the message but leave the listing of exits as it is, then simply override cannotGoThatWayMsg, e.g.:</p>

<p><pre>
cellar: DarkRoom 'Cellar'
    "The cellar is almost bare. A flight of stairs leads up to the north. " 
    north = cellarStairs
    up asExit(north)    
    cannotGoThatWayMsg = 'There\'s obviously nothing in that direction. '
;
</pre></p>
<p>This would result in:</p>
<p><pre>
<b>&gt;e</b>
There's obviously nothing in that direction. The only obvious exit leads north, 
back to the hall (west end). 
</pre></p>
<p>Note that this could be improved by giving a destName to <a href='#hallWest'>hallWest</a> so that we'd see something like "back to the west end of the hall" rather than "back to the hall (west end)".</p>

<p>The alternative is to replace the entire output by overriding cannotGoThatWay():</p>
<p><pre>
cellar: DarkRoom 'Cellar'
    "The cellar is almost bare. A flight of stairs leads up to the north. "    
    north = cellarStairs
    up asExit(north)    
    cannotGoThatWay = "There's no point blundering around in that direction; you
        know perfectly well that the only way out of here is back &lt;&lt;aHref('UP',
            'up','Go up')&gt;&gt; the stairs. "    
;
</pre></p>
<p>Using the aHref() function is the icing on the cake here; it provides a hyperlink on the word "up" in the output text that the player can click to go up from the cellar, but there's no need to do this if you don't want to. The effect of this override is to produce:</p>

<p><pre>
<b>&gt;e</b>
There's no point blundering around in that direction; you know perfectly well that the 
only way out of here is back <A href='#d'>up</A> the stairs. "
</pre></p>


<a href='#r40'>[back]</a>
<br>

<h3><a name='darkannounce'>[41] Announcement of Darkness</a></h3>
<p>The mechanism for recognizing and responding to the onset of light or darkness (involving the NoteDarknessAction and Actor.noteConditionsAfter()) has already been described <a href='#nowlight'>above</a>. The new point to note here is that the actual message announcing the darkness ('It is now pitch black') comes from playerActionMessages.newlyDarkMsg. If we wanted to change it this message, this would therefore be the most convenient place to change it, e.g.:</p>
<p><pre>
modify playerActionMessages
    newlyDarkMsg = 'Now it\'s too dark to see anything. '
;
</pre></p>
   
<a href='#r41'>[back]</a>
<br>   

<h3><a name='darkgo'>[42] Cant Go in Darkness</a></h3>
<p>This message is produced by the method cannotGoThatWayInDark(), called on the current location. By default it displays playerActionMessages.cannotGoThatWayInDarkMsg, but obviously it could be overridden to display any message you like, e.g.:</p>
<p><pre>
cellar: DarkRoom 'Cellar'
    "The cellar is almost bare. A flight of stairs leads up to the north. " 
    north = cellarStairs
    up asExit(north)    
    cannotGoThatWayInDark = "Although it's dark and you can hardly see a thing
        down here, you're pretty certain that the only way out is back up the
        stairs. "    
;
</pre></p>



<a href='#r42'>[back]</a>
<br>   

<h3><a name='fuse'>[43] Winning Cut-Scene</a></h3>
<p>There are several distant ways we could generate this brief closing cut-scene. This one was implemented by setting up a Fuse in the enteringRoom() method of <a href='#hallWest'>hallWest</a> if the player enters the room carrying the photograph; the fuse then executes at the end of the turn, displaying the message and ending the game.</p>

<a href='#r43'>[back]</a>
<br>

<h3><a name='winning'>[44] Winning Message</a></h3>
<p>This winning message, which marks the end of the game, is here generated by the call to finishGameMsg() in the (custom) winGame() method on <a href='#hallWest'>hallWest</a>.</p>
<p>finishGameMsg() can either be called with a literal single-quoted string as its first argument (as in this example), or with a FinishType object. If it's called with a literal string, that literal string is displayed as the winning messages. If it's called with a FinishType object, that object's finishMsg is displayed. The library defines four FinishType objects: ftVictory ('You have won'), ftDeath ('You have died'), ftFailure ('You have failed') and ftGameOver ('Game Over'). You can define additional FinishType objects if you like, but this is only worthwhile if you want to use them more than once (i.e. if the same ending message can be displayed from calls to finishGameMsg at several different places in your code).</p>
<p>The second parameter used by finishGameMsg is a list of FinishOption objects. Once the game is over the parser will always offer the player the option to RESTORE, RESTART or QUIT, but here the author can offer the player additional options, in this case UNDO and FULL SCORE (using finishOptionUndo and finishOptionFullScore). Other FinishOption types that can be used include finishOptionScore, finishOptionAmusing, and finishOptionCredits.</p>

<a href='#r43'>[back]</a>
<br>

<h3><a name='finalscore'>[45] Final Score Notification</a></h3>
<p>This final score notification is generated from a call to libGlobal.scoreObj.showScore() in the finishGameMsg() function (which was called from author code; see the definition of <a href='#hallWest'>hallWest</a>.winGame).</p>

<a href='#r43'>[back]</a>
<br>

<h3><a name='fullscore'>[46]</a></h3>
<p>The FULL SCORE command generates this report of the score and list of achievements by calling libScore.showFullScore(). The points awarded for and description of each achievement listed are defined on the various Achievement objects defined in the game and activated by a call to awardPointsOnce(). For a fuller account of the scoring system see the comments in <a href='../libref/source/score.t.html'>score.t</a>.</p>
<a href='#r46'>[back]</a>
<br>

<h3><a name='goodbye'>[47] Goodbye Message</a></h3>
<p>This farewell message is produced by the showGoodbye() method on <a href='#gameMain'>gameMain</a>.</p>
<a href='#r46'>[back]</a>
<br>
<hr>
<h2><a name='sourcecode'>The Source Code</a></h2>
<p><pre>
#charset "us-ascii"

#include &lt;tads.h&gt;
#include "advlite.h"



/*
 *   Our game credits and version information.  This object isn't required
 *   by the system, but our GameInfo initialization above needs this for
 *   some of its information.
 *   
 *   IMPORTANT - You should customize some of the text below, as marked:
 *   the name of your game, your byline, and so on.  
 */
<a name='#versionInfo'>versionInfo</a>: GameID
    name = 'TADS 3 Starter Game'
    byline = 'by An Author'
    htmlByline = 'by &lt;a href="mailto:your-email@your-address.com"&gt;
                  YOUR NAME&lt;/a&gt;'
    version = '1.0'
    authorEmail = 'YOUR NAME &lt;your-email@your-address.com&gt;'
    desc = 'CUSTOMIZE - this should provide a brief description of
            the game, in plain text format.'
    htmlDesc = 'CUSTOMIZE - this should provide a brief description
                of the game, in &lt;b&gt;HTML&lt;/b&gt; format.'

    showCredit()
    {
        /* show our credits */
        "Put credits for the game here. ";

        /* 
         *   The game credits are displayed first, but the library will
         *   display additional credits for library modules.  It's a good
         *   idea to show a blank line after the game credits to separate
         *   them visually from the (usually one-liner) library credits
         *   that follow.  
         */
        "\b";
    }
    showAbout()
    {
        "This is just a brief demo game to illustrate where various messages
        come from in TADS 3. Or you could think of it as a high adventure with
        deep characterization, a riveting plot, and a myriad of amazing
        puzzles -- except that if you do think of ir this way you'll be sadly
        disappointed! ";
    }
;


<a name=gameMain>gameMain</a>: GameMainDef
    /* the initial player character is 'me' */
    initialPlayerChar = me

    /* 
     *   Show our introductory message.  This is displayed just before the
     *   game starts.  Most games will want to show a prologue here,
     *   setting up the situation for the player, and show the title of the
     *   game.  
     */
    showIntro()
    {
        "Welcome to the TADS 3 Starter Game!\b";     
    }

    /* 
     *   Show the "goodbye" message.  This is displayed on our way out,
     *   after the user quits the game.  You don't have to display anything
     *   here, but many games display something here to acknowledge that
     *   the player is ending the session.  
     */
    showGoodbye()
    {
        "<.p>Thanks for playing!\b";
    }
;

me: Player
    location = boxRoom   
    desc = "You're neither as young as you used to be or as young as you'd like
        to be. "
;

<a name=boxRoom>boxRoom</a>: Room 'Box Room'
    "This large box room is strewn with junk. The only way out is via a door
    to the east. "
    east = boxDoor
;

+ boxDoor: Door 'door'
    "It's just a plain door, painted white. "
;

+ <a name='junk'>Decoration</a> 'junk' 
    "All sorts of stuff, the accumulated detritus of decades, mostly not worth
    bothering with. "
;

+ <a name=largeBox>largeBox</a>: OpenableContainer 'large red box' 
    "It's large, red and box-shaped. "
    initSpecialDesc = "A large red box sits in the corner. "    
;

++ teddy: Thing 'old teddy bear' 
    "The old teddy stills shows the dreadful effects of too much love from an
    over-enthusiastic child, but has long since suffered years of neglect. "
;

++ legoBrick: Thing 'red lego brick'
;

++ torch: Flashlight 'large black torch;;flashlight'
    "It looks sturdy enough, and seems to be in good working order. "
;

+ <a name=table>Heavym Surface</a>, Heavy 'small square table' 
    specialDesc = "A small square table stands in the middle of the room. "
;

++ <a name='smallBox'>smallBox: LockableContainer</a> 'small blue box'
;

+++ redCrayon: Crayon 'red +' 
;

+++ blueCrayon: Crayon 'blue +' 
;    

+++ yellowCrayon: Crayon 'yellow +' 
;


+ oldCoat: Wearable 'old coat; brown'
    "It's brown, but not too motheaten. "
;

+ <a name='greenBook'>greenBook</a>: Thing  'small green book; getting started'    
    "It's a copy of <i>Getting Started in TADS 6</i>. "
    readDesc = "Reading the book brings back happy memories of writing IF in
        your early twenties. With TADS 6 all you had to do was fill in a form
        specifying the genre of the game, the names of a few key NPCs, and the
        median age of the target audience, select a plot-type from a drop-down
        list, and then hit either the &lt;q&gt;generate two-hour version for
        IF-Comp&lt;/q&gt; button or &lt;q&gt;generate long version&lt;/q&gt; button, and a
        bug-free, typo-free TADS 6 game would be instantly created for you.
        Shame so many diehards on rec.arts.int-fiction thought this took all the
        fun out of creating IF."
;

+ <a name='sock'>oddSock</a>: Wearable 'odd sock; green'
    "Washing machines have a habit of swallowing odd socks, and this one (which
    happens to be green) must be the survivor of what was once a pair. "
;

+ tennisBall: Thing 'tennis ball; split'
    "This one has been split open; it's no good for playing tennis with any
    more. "
;

class Crayon: Thing 'crayon'
;


<a name='landing'>landing</a>: Room 'Landing'
    "A flight of stairs leads down to the south, while a door leads into the box
    room just to the west. "
    roomFirstDesc = "Emerging from the box room you find yourself standing at
        the top of a flight of stairs leading down to the south. "
    west = landingDoor
    south = landingStairs
    down asExit(south)
;

+ landingDoor: Door ->boxDoor 'box room door*doors' 'box room door'
;

+ <a name='stairway'>landingStairs</a>: StairwayDown 
    'flight of stairs[n];;;it them'
    travelDesc = "You walk briskly down the stairs. "
    
    destination = hallEast
;

<a name='dconn'></a> 
hallRegion: SenseRegion
    rooms = [hallEast, hallWest]
;

<a name='hallEast'>hallEast</a>: Room 'Hall (East End)' 'east end of the hall[n]'
    "This large hall continues to the west. A flight of stairs leads up to the
    north. "
    inRoomName(pov) { return 'at the far end of the hall'; }
    north = hallStairs
    up asExit(north)
    west = hallWest
;

+ hallStairs: StairwayUp 'flight of stairs[n]'
    destination = landing
;


+ <a name='duck'>rubberDuck: Thing 'rubber duck; yellow'
    "It's yellow. "
    afterAction()
    {
        if(gActionIs(Jump))
        {
            moveInto(isIn(hallEast) ? hallWest: hallWest);
            &quot;&lt;.p&gt;As if startled by your sudden exertion, the rubber duck lets
            out a clockwork quack and waddles to the other end of the hall. ";
        }
    }  
;


<a name='hallWest'>hallWest</a>: Room 'Hall (West End)' 'west end of the hall[n]'
    "This large hall continues to the east. A flight of stairs leads down to the
    south. "
    east = hallEast  
    south = hallStairsDown
    down asExit(south)
    
    travelerEntering(traveler, origin) 
    {
        if(photo.isIn(traveler))
            new Fuse(self,&amp;winGame, 0);
    }
    
    winGame()
    {
        "You turn to Mavis and hand her the photograph of Buster Keaton. She
        snatches it eagerly from your grasp, instantly stops her moaning, and
        showers the actor's picture with delighted kisses.\b";
        
        achievement.awardPointsOnce();
        
        finishGameMsg('You have made an old lady very happy', [finishOptionUndo,
            finishOptionFullScore]);
    }
    
    achievement: Achievement { +10 "making Mavis happy" }
;

+ woodenChair: Platform 'wooden chair'
    canLieOnMe = nil
;

+ hallStairsDown: StairwayDown 'flight of stairs[n];;;it them'
    destination = cellar
;

<a name='cellar'>cellar</a>: DarkRoom Room 'Cellar'
    "The cellar is almost bare. A flight of stairs leads up to the north. "
    north = cellarStairs
    up asExit(north)
    isLit = nil
;

+ cellarStairs: StairwayUp 
    'flight of stairs[n];;;it them'
    destination = hallWest
;


+ <a name='photo'>photo</a>: Thing 'photo of Buster Keaton; favourite; picture photograph'
    "The picture shows Buster Keaton posing in a Confederate uniform in The
    General. "
        
    dobjFor(Take)
    {
        action()
        {
            inherited;
            achievement.awardPointsOnce();
        }
    }
   achievement: Achievement { +10 "retrieving the photograph" }
;


<a name='mavis'>mavis</a>: Actor 'Mavis; old; woman; her' @woodenChair
    "She's a funny old woman, when all's said and done. "
    sightSize = large   
;

+ <a name='hermit'>ActorState
    isInitState = true
    noResponse = "The old woman simply rocks back and forth in her chair
        moaning, <q>Woe, woe, woe is me!</q>"
    stateDesc = "She's rocking back and forth in her chair moaning <q>Woe!</q> "
    
    specialDesc = "Mavis is sitting on the wooden chair. " 
    
    remoteSpecialDesc(pov)
    {
        "Mavis is sitting on a wooden chair at the far end of the hall. "; 
    }
    
;

<a name='harold'>harold</a>: Actor 'Harold;;twin man brother;him' @hallWest
    "He's about your height and build, and really looks quite a lot like you.
    Since he's your twin brother this is not altogether surprising. "
    sightSize = large    
;



+ <a name='hWaiting'>hWaiting</a>: ActorState
    specialDesc = "Harold is standing by Mavis\'s chair. "  
    isInitState = true
;

++ HelloTopic
    "<q>Hello, Harold!</q> you say.\b
    <q>Hi there!</q> he replies. "    
    
    changeToState = hTalking
;

+ hTalking: ActorState
    specialDesc = "Harold is standing by Mavis\'s chair, waiting for you to
        speak. "    
;

++ <a name='mavisask'>AskTopic @mavis
    &quot;&lt;q&gt;What's up with Mavis?&lt;/q&gt; you ask.\b
    &lt;q&gt;She's inconsolable -- she can't find her favourite photograph of Buster
    Keaton,&lt;/q&gt; he tells you. &lt;&lt;gSetKnown(photo)&gt;&gt;&quot;
    name = 'Mavis'
;

++ <a name='photoask'>AskTopic, StopEventList @photo</a>
    [
        '&lt;q&gt;Where did Mavis leave the photo?&lt;/q&gt; you ask.\b
        &lt;q&gt;I think it may be in the cellar; but it\'s dark down there so I
        couldn\'t find it,&lt;/q&gt; he tells you. ',
        
        '&lt;q&gt;You think Mavis\'s photo of Buster Keaton may be in the cellar?&lt;/q&gt;
        you ask.\b
        &lt;q&gt;That\'s right,&lt;/q&gt; he nods, &lt;q&gt;Be a good fellow and get it for her,
        her moaning is getting on my nerves.&lt;/q&gt; '
    ]
    name = 'the photo'
;

++ <a name='deftopic'>DefaultAnyTopic</a>
    "&lt;q&gt;I think you'd better help poor Mavis before we discuss that,&lt;/q&gt; he
    suggests. "
;

</pre>



</div>
<hr class="navb"><div class="navb">
<i>TADS 3 Technical Manual</i><br>
<a class="nav" href="toc.htm">Table of Contents</a> | 
<a class="nav" href="depth.htm">TADS 3 In Depth</a> &gt; 
Where Messages Come From
<br><span class="navnp"><a class="nav" href="depth.htm"><i>Prev:</i> TADS 3 In Depth</a> &nbsp;&nbsp;&nbsp; <a class="nav" href="t3res.htm"><i>Next:</i> Action Results</a> &nbsp;&nbsp;&nbsp; </span>

</div>
</body>
</html>
