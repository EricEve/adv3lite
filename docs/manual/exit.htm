<html>
<!-- DERIVED FILE - DO NOT EDIT -->

<head>
<title>Optional Modules &mdash; Exits</title>
<link rel="stylesheet" href="sysman.css" type="text/css">
</head>
<body>
<div class="topbar"><img src="topbar.jpg" border=0></div>
<div class="nav">
<a class="nav" href="toc.htm">Table of Contents</a> | 
<a class="nav" href="optional.htm">Optional Modules</a> &gt; 
Exits
<br><span class="navnp"><a class="nav" href="eventlist.htm"><i>Prev:</i> EventLists</a> &nbsp;&nbsp;&nbsp; <a class="nav" href="extra.htm"><i>Next:</i> Extras</a> &nbsp;&nbsp;&nbsp; </span>

</div>
<div class="main">
<h1>Exits</h1>
<p>The exits.t module provides the status line exit lister and a list of exits in response to an EXITS command or when the player character attempts to travel in a direction where there isn't an exit. There normally isn't any need to exclude the exits module, since the player can always disable the status line exit listing if s/he wishes with an EXITS OFF command. There usually won't be much need for game authors to intervene with the functions of the Exits module either, since they should just work if the module is present. But there are a few features it could be useful for game authors to know about.</p>

<p>One feature the adv3Lite exit lister introduces is the ability to have the status line exit lister show exits that lead to unvisited locations in a different colour (currently the options are red, blue, green and yellow, with green as the current default). The player can enable or disable this feature with the commands <span class="cmdline">EXIT COLOUR|COLOR ON|OFF</span> and can select the colour to be used with the command <span class="cmdline">EXIT COLOUR|COLOR RED|BLUE|GREEN|YELLOW</span>. The game author can also change these settings programmatically (or, more usefully, set the initial values of these setting for a game) by overriding or changing the <b>highlightUnvisitedExits</b> (true or nil) and <b>unvisitedExitColour</b> ('red', 'blue', 'green' or 'yellow') properties on the statuslineExitLister object. (In fact unvisitedExitColour can be set to any value that would be legal in a &lt;FONT COLOR=<i>color</i>&gt; tag).</p>

<p>A room is considered to have been visited if the player character has seen it (i.e., has seen a description of the room when the room was illuminated). Normally it will be clear enough what this means, but one special case may need explaining further. If a direction property of a room is implemented as a method (instead of pointing to a TravelConnector, Door or Room), the exit will be shown in the status line exit lister, and originally shown as unvisited. Once the player character has attempted to traverse the exit, its destination will be shown as visited, even if the exit doesn't actually lead anywhere. In practice, this is normally the desired behaviour, since the distinctive colouring of unvisited exits in the status line exit lister is intended as an indication of which exits might still need exploring, and an exit that doesn't lead anywhere doesn't need any further exploration.</p>

<p>Internally, the library keeps a record of where exits implemented as methods lead to in a LookupTable on libGlobal.extraDestInfo. It adds entries to this table whenever an exit implemented as a method is traversed, noting where the player character actually ends up. By default (when there's no entry) this LookupTable returns a value of unknownDest_, which is a dummy destination that is never visited (so that initially any exit implemented as a method will be shown as leading to an unvisited location, since the library will regard it as leading to unknownDest_). Once the player character tries to go via such an exit, the actual destination where the player character ends up is stored in libGlobal.extraDestInfo, even if the player in fact stays put (in which case his current location will be recorded as the destination). Since the player character current location (or indeed, anywhere else the player character ends up) always counts as visited (unless it's dark), from then on the corresponding exit will be shown as leading to a visited location.</p>

<p>By default, the response to an explicit EXITS command will show the name (or rather <code>destName</code>) of any known destinations along with the directions that lead to them (for this purpose a destination is known if it has been visited or is otherwise familiar). If you want to suppress the inclusion of (known) destination names you can so by setting <code>explicitExitLister.showDestNames</code> to nil.</p>

<h2 id='custom'>Customizing how Exits are Listed</h2>
<p>There are four properties of the <code>Room</code> class you can use to customize the way exits are listed when the player character is in a specific room. All of these should be defines on a specific room (or a class of Room).</p>

<p><b>noExits</b>: If this is defined as either a single-quoted string or a method that returns a single-quoted string, then the status-line exit lister will use that string in place of the default <i>None</i> if there are no exits (or no apparent exits) from the room. This may be useful, for example, when <i>None</i> could be potentially misleading because there is a way out of the room that the player has to find.</p>
<p><b>listStatusExits(lst, cnt)</b>: this can be defined to display text in place of the normal list of exits, where <i>lst</i> is the list of DestInfo objects encapsulating the exits and <i>cnt</i> is the number of exits. The relevant properties of DestInfo objects are <code>dir_</code>, the Direction in which the exit leads, and <code>dest_</code>, the destination to which it leads. It may be be useful to define this method if, for example, we want to hide exits in a maze or represent a situation where the player has become disoriented. For example we might define:</p>

<p><code>listStatusExits(lst, cnt) { "confusing!"; }</code></p>

<p><b>listExits(lst, cnt)</b>: This can be defined in much the same way as <code>listStatusExits(lst, cnt)</code> to change the way exits in the room are listed in response to an explicit EXITS command or as part of a cannot go that way message, for example:</p>

<p><code>listExits(lst, cnt) { "&lt;&lt;cnt&gt;&gt; different ways"; }</code></p>



<p>In this case the text you display will follow "From here you could go ". You can change this to something else by defining <b>exitListPrefix(cnt)</b> on the room (where <i>cnt</i> is once again the number of exits), e.g.:</p>

<p><code>exitListPrefix(cnt) { "Leading off from here &lt;&lt;cnt &gt; 1 ? 'are' : 'is'&gt;&gt; "; }</code></p>

<p>Returning true from <code>listExits()</code> or <code>listStatusExits()</code> allows the normal listing of exits to go ahead. This might be useful if, for example, we only want exits to be listed when a room is illuminated: </p>

<pre><code>
   listStatusExits(lst, cnt)
   {
      if(isIlluminated)
         return true;
      
      "too dark to discern";
      return nil;
   }
</code></pre>


<p>This all assumes that you want to change the way exits are shown for specific rooms. To customise the exit listers globally you can follow the suggestions in the section on <a href='lister.htm#custom'>Listers</a>. The listers to modify would be the <code>statuslineExitLister</code> and/or the <code>explicitExitLister</code>.

</div>
<hr class="navb"><div class="navb">
<i>adv3Lite Library Manual</i><br>
<a class="nav" href="toc.htm">Table of Contents</a> | 
<a class="nav" href="optional.htm">Optional Modules</a> &gt; 
Exits
<br><span class="navnp"><a class="nav" href="eventlist.htm"><i>Prev:</i> EventLists</a> &nbsp;&nbsp;&nbsp; <a class="nav" href="extra.htm"><i>Next:</i>Extras </a> &nbsp;&nbsp;&nbsp; </span>

</div>
</body>
</html>