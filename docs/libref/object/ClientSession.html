<html>
<head><link rel=stylesheet type="text/css" href="../libref.css"><title>ClientSession</title></head><body>
<table class=ban><tr><td align=left><span class=title>ClientSession</span><span class=type>class</span><td align=right><a href="../file/webui.t.html">webui.t</a>[<a href="../source/webui.t.html#379">379</a>]</table><p>
<table class=nav><tr>
<td><a href="#_SuperClassTree_">Superclass<br>Tree</a>
<td><a href="#_SubClassTree_">Subclass<br>Tree</a>
<td><a href="#_ObjectSummary_">Global<br>Objects</a>
<td><a href="#_PropSummary_">Property<br>Summary</a>
<td><a href="#_MethodSummary_">Method<br>Summary</a>
<td><a href="#_Properties_">Property<br>Details</a>
<td><a href="#_Methods_">Method<br>Details</a>
</table><div class=fdesc>
   Client session.  This represents a connection to one browser (or other   client application).  Each browser client is a separate session, so we   create one instance of this class per connected browser.  Note that   browser instances don't necessarily represent different users - a   single user could open multiple browser windows on the same server. <p>   We identify each browser instance via a session cookie, which we   establish when the client connects.  The browser sends the cookie with   each subsequent request, allowing us to tie the request to the browser   session we previously set up. 
<p>
<code>class 
<b>ClientSession</b> :  &nbsp; object</code>
</div>
<a name="_SuperClassTree_"></a><p><div class=mjhd><span class=hdln>Superclass Tree</span> &nbsp; (in declaration order)</div><p>
<code><b>ClientSession</b></code><br>
<code> &nbsp; &nbsp; &nbsp; &nbsp; object</code><br>
<a name="_SubClassTree_"></a><p><div class=mjhd><span class=hdln>Subclass Tree</span> &nbsp; </div><p>
<i>(none)</i>
<a name="_ObjectSummary_"></a><p><div class=mjhd><span class=hdln>Global Objects</span> &nbsp; </div><p>
<i>(none)</i>
<a name="_PropSummary_"></a><p><div class=mjhd><span class=hdln>Summary of Properties</span> &nbsp; </div><p>
<code>
<a href="#clientKey">clientKey</a>&nbsp; 
<a href="#downloads">downloads</a>&nbsp; 
<a href="#ifdbTuid">ifdbTuid</a>&nbsp; 
<a href="#isAlive">isAlive</a>&nbsp; 
<a href="#isPrimary">isPrimary</a>&nbsp; 
<a href="#lastEventTime">lastEventTime</a>&nbsp; 
<a href="#pendingEvts">pendingEvts</a>&nbsp; 
<a href="#pendingReqs">pendingReqs</a>&nbsp; 
<a href="#screenName">screenName</a>&nbsp; 
<a href="#storageSID">storageSID</a>&nbsp; 
<a href="#uiPrefs">uiPrefs</a>&nbsp; 
</code><p>
<a name="_MethodSummary_"></a><p><div class=mjhd><span class=hdln>Summary of Methods</span> &nbsp; </div><p>
<code>
<a href="#addDownload">addDownload</a>&nbsp; 
<a href="#allDownloads">allDownloads</a>&nbsp; 
<a href="#broadcastDownload">broadcastDownload</a>&nbsp; 
<a href="#broadcastEvent">broadcastEvent</a>&nbsp; 
<a href="#cancelDownload">cancelDownload</a>&nbsp; 
<a href="#checkDisconnect">checkDisconnect</a>&nbsp; 
<a href="#construct">construct</a>&nbsp; 
<a href="#disconnectAll">disconnectAll</a>&nbsp; 
<a href="#find">find</a>&nbsp; 
<a href="#flushEvents">flushEvents</a>&nbsp; 
<a href="#getPrimary">getPrimary</a>&nbsp; 
<a href="#processQueues">processQueues</a>&nbsp; 
<a href="#requestEvent">requestEvent</a>&nbsp; 
<a href="#sendEvent">sendEvent</a>&nbsp; 
<a href="#sendKeepAlive">sendKeepAlive</a>&nbsp; 
<a href="#setDefaultScreenName">setDefaultScreenName</a>&nbsp; 
<a href="#shutdownWait">shutdownWait</a>&nbsp; 
<a href="#updateEventTime">updateEventTime</a>&nbsp; 
</code><p>
<a name="_Properties_"></a><p><div class=mjhd><span class=hdln>Properties</span> &nbsp; </div><p>
<a name="clientKey"></a>
<table class=decl><tr><td><code>clientKey</code><td align=right><code><a href="../file/webui.t.html">webui.t</a>[<a href="../source/webui.t.html#439">439</a>]</table><div class=desc>   The client session key.  This identifies the client across   requests.  We send this to the client as a cookie when they   connect, so we get it back on each request. <p>
</div>
<a name="downloads"></a>
<table class=decl><tr><td><code>downloads</code><td align=right><code><a href="../file/webui.t.html">webui.t</a>[<a href="../source/webui.t.html#619">619</a>]</table><div class=desc>this client's list of downloadable temporary files<p>
</div>
<a name="ifdbTuid"></a>
<table class=decl><tr><td><code>ifdbTuid</code><td align=right><code><a href="../file/webui.t.html">webui.t</a>[<a href="../source/webui.t.html#422">422</a>]</table><div class=desc>the client's IFDB user ID (a "TUID"), if logged in to IFDB<p>
</div>
<a name="isAlive"></a>
<table class=decl><tr><td><code>isAlive</code><td align=right><code><a href="../file/webui.t.html">webui.t</a>[<a href="../source/webui.t.html#463">463</a>]</table><div class=desc>   Is this session alive?  When we detect that the client has   disconnected, we'll set this to nil.  When waiting for a client in   a modal event loop, this can be used to terminate the wait if the   client disconnects. <p>
</div>
<a name="isPrimary"></a>
<table class=decl><tr><td><code>isPrimary</code><td align=right><code><a href="../file/webui.t.html">webui.t</a>[<a href="../source/webui.t.html#455">455</a>]</table><div class=desc>   Am I the primary player?  This is true if the player connected   using the primary session key.  Collaborative players join through   the separate collaborative session key. <p>
</div>
<a name="lastEventTime"></a>
<table class=decl><tr><td><code>lastEventTime</code><td align=right><code><a href="../file/webui.t.html">webui.t</a>[<a href="../source/webui.t.html#472">472</a>]</table><div class=desc>   Last request time, in system ticks (ms).  We use this to determine   how long it's been since we've heard from the client, for timeout   purposes.  This is updated any time we receive a command or event   request from the client, and each time we successfully send an   event reply. <p>
</div>
<a name="pendingEvts"></a>
<table class=decl><tr><td><code>pendingEvts</code><td align=right><code><a href="../file/webui.t.html">webui.t</a>[<a href="../source/webui.t.html#432">432</a>]</table><div class=desc>   The client's event queue.  When a server-to-client event occurs,   we post it to each current client's queue.  When the client sends   a get-event request, we satisfy it out of this queue. <p>
</div>
<a name="pendingReqs"></a>
<table class=decl><tr><td><code>pendingReqs</code><td align=right><code><a href="../file/webui.t.html">webui.t</a>[<a href="../source/webui.t.html#425">425</a>]</table><div class=desc>the list of pending event requests from this client<p>
</div>
<a name="screenName"></a>
<table class=decl><tr><td><code>screenName</code><td align=right><code><a href="../file/webui.t.html">webui.t</a>[<a href="../source/webui.t.html#406">406</a>]</table><div class=desc>   The client's "screen name" - this is the user-visible name that   we'll show other users to identify commands and chat messages   entered by this client. <p>
</div>
<a name="storageSID"></a>
<table class=decl><tr><td><code>storageSID</code><td align=right><code><a href="../file/webui.t.html">webui.t</a>[<a href="../source/webui.t.html#448">448</a>]</table><div class=desc>   The storage server session key for the user connected to this   session, if any.  We can have multiple users logged in to the game   in collaborative play mode, each with their own separate storage   server session.  This allows each user to have their own private   preference settings, saved games, etc. <p>
</div>
<a name="uiPrefs"></a>
<table class=decl><tr><td><code>uiPrefs</code><td align=right><code><a href="../file/webui.t.html">webui.t</a>[<a href="../source/webui.t.html#399">399</a>]</table><div class=desc>the UI preferences object for this session<p>
</div>
<a name="_Methods_"></a><p><div class=mjhd><span class=hdln>Methods</span> &nbsp; </div><p>
<a name="addDownload"></a>
<table class=decl><tr><td><code>addDownload (desc)</code><td align=right><code><a href="../file/webui.t.html">webui.t</a>[<a href="../source/webui.t.html#597">597</a>]</table><div class=desc>add a download to this client<p>
</div>
<a name="allDownloads"></a>
<table class=decl><tr><td><code>allDownloads ( )</code><td align=right><code><a href="../file/webui.t.html">webui.t</a>[<a href="../source/webui.t.html#622">622</a>]</table><div class=desc>get a list of all of my downloadable files<p>
</div>
<a name="broadcastDownload"></a>
<table class=decl><tr><td><code>broadcastDownload (desc)</code><td align=right><code><a href="../file/webui.t.html">webui.t</a>[<a href="../source/webui.t.html#590">590</a>]</table><div class=desc>broadcast a downloadable file to all clients<p>
</div>
<a name="broadcastEvent"></a>
<table class=decl><tr><td><code>broadcastEvent (msg)</code><td align=right><code><a href="../file/webui.t.html">webui.t</a>[<a href="../source/webui.t.html#478">478</a>]</table><div class=desc>class method: broadcast an event message to all connected clients<p>
</div>
<a name="cancelDownload"></a>
<table class=decl><tr><td><code>cancelDownload (desc)</code><td align=right><code><a href="../file/webui.t.html">webui.t</a>[<a href="../source/webui.t.html#607">607</a>]</table><div class=desc>   Cancel a downloadable file.  Removes the file from the download   list and notifies the client that the file is no longer available. <p>
</div>
<a name="checkDisconnect"></a>
<table class=decl><tr><td><code>checkDisconnect ( )</code><td align=right><code><a href="../file/webui.t.html">webui.t</a>[<a href="../source/webui.t.html#693">693</a>]</table><div class=desc>   Check to see if the client is still alive.  If the client has no   pending event requests, and we haven't heard from the client in   more than the client session timeout interval, assume the client   is no longer connected and kill the session object. <p>   This should be called whenever a sending a reply to a request   fails with a Socket Disconnect exception.  We also run this   periodically during routine housekeeping to check for clients that   haven't even bothered to send a request. <p>
</div>
<a name="construct"></a>
<table class=decl><tr><td><code>construct (skey, ssid)</code><td align=right><code><a href="../file/webui.t.html">webui.t</a>[<a href="../source/webui.t.html#380">380</a>]</table><div class=desc><i>no description available</i><p>
</div>
<a name="disconnectAll"></a>
<table class=decl><tr><td><code>disconnectAll ( )</code><td align=right><code><a href="../file/webui.t.html">webui.t</a>[<a href="../source/webui.t.html#714">714</a>]</table><div class=desc>   Class method: forcibly disconnect all clients.  This simply   deletes the list of active clients and deletes any pending events   in their queues.  This doesn't actually terminate their network   connections, but simply clears out any pending work for each   client that we've initiated on the server side. <p>
</div>
<a name="find"></a>
<table class=decl><tr><td><code>find (key)</code><td align=right><code><a href="../file/webui.t.html">webui.t</a>[<a href="../source/webui.t.html#727">727</a>]</table><div class=desc>   Class method: Find a client session, given the session key or an   HTTPRequest object. <p>
</div>
<a name="flushEvents"></a>
<table class=decl><tr><td><code>flushEvents ( )</code><td align=right><code><a href="../file/webui.t.html">webui.t</a>[<a href="../source/webui.t.html#501">501</a>]</table><div class=desc>flush outstanding events for this client<p>
</div>
<a name="getPrimary"></a>
<table class=decl><tr><td><code>getPrimary ( )</code><td align=right><code><a href="../file/webui.t.html">webui.t</a>[<a href="../source/webui.t.html#755">755</a>]</table><div class=desc>   Get the primary session.  This is the session for the original   initiating user (the "host" in a multi-user game). <p>
</div>
<a name="processQueues"></a>
<table class=decl><tr><td><code>processQueues ( )</code><td align=right><code><a href="../file/webui.t.html">webui.t</a>[<a href="../source/webui.t.html#625">625</a>]</table><div class=desc>process the request and response queues<p>
</div>
<a name="requestEvent"></a>
<table class=decl><tr><td><code>requestEvent (req)</code><td align=right><code><a href="../file/webui.t.html">webui.t</a>[<a href="../source/webui.t.html#493">493</a>]</table><div class=desc>receive an event request from the client<p>
</div>
<a name="sendEvent"></a>
<table class=decl><tr><td><code>sendEvent (msg)</code><td align=right><code><a href="../file/webui.t.html">webui.t</a>[<a href="../source/webui.t.html#485">485</a>]</table><div class=desc>send an event to this client<p>
</div>
<a name="sendKeepAlive"></a>
<table class=decl><tr><td><code>sendKeepAlive ( )</code><td align=right><code><a href="../file/webui.t.html">webui.t</a>[<a href="../source/webui.t.html#553">553</a>]</table><div class=desc>   Send a keep-alive reply to each pending request from this client   that's been waiting for longer than the timeout interval. <p>   Javascript clients in principle will wait indefinitely for an   XmlHttpRequest to complete, but in practice browsers tend to set   fairly long but finite time limits.  If the time limit is exceeded   for a request, the client will fail the request with an error.  To   prevent this, our main event loop (processNetRequests)   periodically calls this routine if no other events have occurred   recently.  We'll clear out the pending event request queue for   each client by sending a no-op reply to each event.  This tells   the client that the server is still alive and connected but has   nothing new to report. <p>
</div>
<a name="setDefaultScreenName"></a>
<table class=decl><tr><td><code>setDefaultScreenName ( )</code><td align=right><code><a href="../file/webui.t.html">webui.t</a>[<a href="../source/webui.t.html#409">409</a>]</table><div class=desc>set the default screen name for a client<p>
</div>
<a name="shutdownWait"></a>
<table class=decl><tr><td><code>shutdownWait (timeout)</code><td align=right><code><a href="../file/webui.t.html">webui.t</a>[<a href="../source/webui.t.html#675">675</a>]</table><div class=desc>wait for the queues to empty in preparation for shutting down<p>
</div>
<a name="updateEventTime"></a>
<table class=decl><tr><td><code>updateEventTime ( )</code><td align=right><code><a href="../file/webui.t.html">webui.t</a>[<a href="../source/webui.t.html#475">475</a>]</table><div class=desc>update the last event time for this client<p>
</div>
<div class=ftr>Adv3Lite Library Reference Manual<br>Generated on 03/03/2025 from adv3Lite version 2.2.0.3</div>
</body>
</html>
